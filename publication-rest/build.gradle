dependencies {
    //This package is added by SAM template in the runtime environment
    implementation(project(':publication-commons')) {
        exclude group: "software.amazon.ion", module: "ion-java"
    }
    implementation project(':datacite-commons')
    implementation project(':schema-org-metadata')
    implementation project(":tickets")

    implementation libs.nva.apigateway
    implementation libs.nva.core
    implementation libs.nva.json
    implementation libs.nva.identifiers
    implementation libs.nva.clients
    implementation(libs.nva.datamodel.core) {
        exclude group: 'com.github.bibsysdev', module: 'nva-commons'
    }
    implementation libs.nva.secrets

    implementation libs.nva.doi.partner.data

    implementation libs.bundles.jaxb
    implementation libs.jackson.databind
    implementation libs.jackson.core
    implementation libs.bundles.logging

    implementation libs.aws.sdk.dynamodb
    implementation libs.aws.lambda.java.core
    implementation libs.guava
    implementation libs.aws.sdk2.secrets

    testImplementation project(":publication-testing")
    testImplementation project(path: ':tickets-test')
    testImplementation libs.bundles.testing
    testImplementation libs.nva.datamodel.testutils
    testImplementation libs.logutils
    testImplementation libs.nva.testutils
    testImplementation libs.zalando
    testImplementation libs.wiremock
    testImplementation(libs.httpcore) {
        because "aws-java-sdk-dynamodb needs and we are using it indirectly"
    }

    compileOnly(libs.aws.sdk.apigateway) {
        because "PMD complains for the com/amazonaws/regions/Regions class"
    }
}

test {
    environment "ALLOWED_ORIGIN", "*"
    environment "AWS_REGION", "eu-west-1"
    environment "COGNITO_HOST", "https://example.com"
    environment "ID_NAMESPACE", "https://www.example.org/publication"
    environment "BACKEND_CLIENT_AUTH_URL", "localhost"
    environment "BACKEND_CLIENT_SECRET_NAME", "secret"
    environment "TABLE_NAME", "ResourcesTable"
    environment "BACKEND_CLIENT_AUTH_URL", "https://auth.example.com"
    environment "EXTERNAL_USER_POOL_URI", "https://external-user-pool.example.com"
    environment "API_HOST", "https://api-host.example.com"
}

