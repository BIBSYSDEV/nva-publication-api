dependencies {
    implementation project(":publication-doi-commons")
    implementation project(":expansion")
    implementation project(":publication-commons")
    implementation project(":publication-log")
    testImplementation project(":tickets-test")

    implementation project(":publication-model")

    implementation libs.nva.eventhandlers
    implementation libs.nva.core
    implementation libs.nva.json
    implementation libs.nva.s3
    implementation libs.nva.secrets
    implementation libs.nva.apigateway
    implementation libs.nva.auth
    implementation libs.nva.clients
    implementation libs.aws.core
    implementation libs.aws.lambda.java.core
    implementation libs.aws.lambda.events
    implementation libs.aws.java.sdk.core
    implementation libs.guava

    implementation libs.aws.sdk.dynamodb
    implementation libs.aws.sdk2.s3
    implementation libs.aws.sdk2.urlconnectionclient
    implementation libs.aws.sdk2.eventbridge
    implementation libs.aws.sdk2.sqs
    implementation libs.aws.sdk2.httpClientApi
    implementation libs.aws.sdk2.auth
    implementation libs.aws.sdk2.regions
    implementation libs.aws.sdk2.core
    implementation libs.aws.sdk2.secrets
    implementation libs.aws.apache.client

    implementation libs.jackson.annotations
    implementation libs.jackson.databind
    implementation libs.jackson.core

    implementation libs.jakarta.validation.api

    implementation libs.bundles.logging

    testImplementation libs.wiremock

    implementation libs.vavr
    implementation libs.resilience4j.all

    testImplementation libs.bundles.testing
    testImplementation libs.nva.identifiers
    testImplementation project(":publication-model-testing")
    testImplementation project(":publication-testing")

    compileOnly(libs.nva.identifiers) {
        because "PMD complains about no/unit/nva/identifiers/SortableIdentifier"
    }
}

test {
    environment "EVENTS_BUCKET", "theEventsBucket"
    environment "EVENT_BUS_NAME", "eventBus"
    environment "HANDLER_EVENTS_FOLDER", "reource-updates-events"
    environment "PERSISTED_ENTRIES_BUCKET", "persistedEntries"
    environment "AWS_REGION", "AWS_REGION"
    environment "TABLE_NAME", "ResourcesTable"
    environment "AWS_REGION", "eu-west-1"
    environment "ID_NAMESPACE", "https://localhost/publication"
    environment "BACKEND_CLIENT_AUTH_URL", "https://auth.example.com"
    environment "BACKEND_CLIENT_SECRET_NAME", "secret"
    environment "DOMAIN_NAME", "localhost"
    environment "OUTPUT_EVENT_TOPIC", "someEvent"
    environment "API_HOST", "localhost"
    environment "ALLOWED_ORIGIN", "*"
    environment "RECOVERY_QUEUE", "queue"
    environment "CRISTIN_UNITS_S3_URI", "s3://cristin-units"
    environment "NVA_PERSISTED_STORAGE_BUCKET_NAME", "persistedStorage"
}
