dependencies {
    implementation project(":publication-constants")
    implementation project(":publication-doi-commons")
    implementation project(":expansion")
    implementation project(":publication-commons")
    implementation project(":publication-log")
    testImplementation project(":tickets-test")

    implementation project(":publication-model")

    implementation nvaLibs.eventhandlers
    implementation nvaLibs.core
    implementation nvaLibs.json
    implementation nvaLibs.s3
    implementation nvaLibs.secrets
    implementation nvaLibs.apigateway
    implementation nvaLibs.auth
    implementation nvaLibs.clients
    implementation libs.aws.core
    implementation nvaCatalog.aws.lambda.core
    implementation nvaCatalog.aws.lambda.events
    implementation nvaCatalog.aws.java.sdk.core
    implementation nvaCatalog.guava

    implementation nvaCatalog.aws.sdk.dynamo
    implementation nvaCatalog.aws.sdk2.s3
    implementation nvaCatalog.aws.sdk2.urlconnection
    implementation nvaCatalog.aws.sdk2.eventbridge
    implementation nvaCatalog.aws.sdk2.sqs
    implementation libs.aws.sdk2.httpClientApi
    implementation libs.aws.sdk2.auth
    implementation nvaCatalog.aws.sdk2.regions
    implementation nvaCatalog.aws.sdk2.core
    implementation nvaCatalog.aws.sdk2.secrets
    implementation nvaCatalog.aws.apache.client

    implementation nvaCatalog.jackson.annotations
    implementation nvaCatalog.jackson.databind
    implementation nvaCatalog.jackson.core

    implementation libs.jakarta.validation.api

    implementation nvaCatalog.bundles.logging

    testImplementation nvaCatalog.wiremock

    implementation libs.vavr
    implementation libs.resilience4j.all

    testImplementation libs.bundles.testing
    testImplementation nvaLibs.identifiers
    testImplementation project(":publication-model-testing")
    testImplementation project(":publication-testing")

    compileOnly(nvaLibs.identifiers) {
        because "PMD complains about no/unit/nva/identifiers/SortableIdentifier"
    }
}

test {
    environment "EVENTS_BUCKET", "theEventsBucket"
    environment "EVENT_BUS_NAME", "eventBus"
    environment "HANDLER_EVENTS_FOLDER", "reource-updates-events"
    environment "PERSISTED_ENTRIES_BUCKET", "persistedEntries"
    environment "AWS_REGION", "AWS_REGION"
    environment "TABLE_NAME", "ResourcesTable"
    environment "AWS_REGION", "eu-west-1"
    environment "ID_NAMESPACE", "https://localhost/publication"
    environment "BACKEND_CLIENT_AUTH_URL", "https://auth.example.com"
    environment "BACKEND_CLIENT_SECRET_NAME", "secret"
    environment "DOMAIN_NAME", "localhost"
    environment "OUTPUT_EVENT_TOPIC", "someEvent"
    environment "API_HOST", "localhost"
    environment "ALLOWED_ORIGIN", "*"
    environment "RECOVERY_QUEUE", "queue"
    environment "CRISTIN_UNITS_S3_URI", "s3://cristin-units"
    environment "NVA_PERSISTED_STORAGE_BUCKET_NAME", "persistedStorage"
}
