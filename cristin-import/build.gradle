apply plugin: 'io.freefair.lombok'

dependencies {
    implementation project(":publication-constants")
    implementation project(":publication-commons")
    implementation project(":s3-import-commons")

    implementation(libs.nva.datamodel) {
        exclude group: 'com.github.bibsysdev', module: 'nva-commons'
    }

    implementation libs.nva.s3
    implementation libs.nva.core

    implementation libs.nva.eventhandlers

    implementation libs.jackson.annotations
    implementation libs.jackson.databind

    implementation libs.hamcrest.base
    implementation libs.nva.testutils

    runtimeOnly libs.jackson.core
    runtimeOnly libs.jackson.datatype.jsr310
    runtimeOnly libs.jackson.datatype.jdk8

    implementation libs.aws.sdk.dynamodb
    implementation libs.aws.java.sdk.core
    implementation libs.aws.sdk2.core
    implementation libs.aws.sdk2.httpClientApi
    implementation libs.aws.sdk2.urlconnectionclient
    implementation libs.aws.sdk2.regions


    testImplementation project(":storage-model")
    testImplementation project(":publication-testing")
    testImplementation libs.javafaker
    testImplementation libs.nva.testutils
    testImplementation libs.logutils
    testImplementation libs.nva.identifiers
    testImplementation(libs.javers) {
        because "For comparing java objects and detailing the differences in readable way"
    }
    testImplementation libs.aws.sdk2.s3

    testImplementation libs.jackson.core

    compileOnly libs.aws.sdk2.eventbridge
    compileOnly libs.aws.sdk2.s3

    compileOnly(project(":storage-model")) {
        because "PMD complains for no/unit/nva/publication/storage/model/daos/DynamoEntry"
    }
    compileOnly libs.nva.apigateway
    compileOnly libs.zalando
    compileOnly libs.aws.lambda.java.core
    compileOnly libs.nva.identifiers

    compileOnly(libs.aws.sdk2.auth) {
        because "PMD complains about software/amazon/awssdk/auth/credentials/AwsCredentialsProvider "
    }

    compileOnly(group: 'commons-validator', name: 'commons-validator', version: '1.7') {
        because "PMD org/apache/commons/validator/routines/ISBNValidator"
    }

    testImplementation libs.cucumber.java
    testImplementation libs.cucumber.junit
    testImplementation libs.cucumber.picocontainer

}

test {
    useJUnitPlatform {
        includeEngines 'junit-jupiter'
        includeEngines 'junit-vintage'
    }
    environment "MAX_SLEEP_TIME", "1"
    environment "CREATE_CONTRIBUTOR_ID", "true"
    environment "BATCH_EMISSION_INTERVAL_MILLIS", "0"
    environment "DOMAIN_NAME", "test.nva.aws.unit.no"
}

configurations {
    cucumberRuntime {
        extendsFrom testImplementation
    }
}





