plugins {
    id 'nva-publication-api.java-library-conventions'
}

allprojects {
    apply plugin: 'nva-publication-api.java-library-conventions'
}

wrapper {
    distributionType = Wrapper.DistributionType.ALL
    gradleVersion = "7.2"
}

subprojects {
    // For using DynamoDB locally
    configurations.testImplementation.canBeResolved = true
    task copyNativeDeps(type: Copy) {
        from(configurations.testImplementation) {
            include "*.dylib"
            include "*.so"
            include "*.dll"
        }
        into 'build/dynamodb-local'
    }

    test {
        environment "BACKEND_CLIENT_AUTH_URL", "localhost"
        environment "BACKEND_CLIENT_SECRET_NAME", "someSecret"
        dependsOn copyNativeDeps
        systemProperty "java.library.path", 'build/dynamodb-local'
    }
}

build {
    dependsOn jacocoRootReport
}

dependencies {
    implementation 'com.github.bibsysdev:logutils:1.27.2'
}

repositories {
    mavenCentral()
}
